<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document</title><link rel="stylesheet" href="./css/index.css"><script src="./js/jquery-1.12.4.min.js"></script><script src="./js/template-native.js"></script><!-- 创建模板 --><script id="tem" type="text/html"><!-- 将拿到的数据中 的 comments 变量进行遍历 -->
    <!-- 在每个li标签中添加一个自定义标签属性，记录自己的id --> <% for (var i = 0 ; i < comments.length ; i++) { %> <li uid="<%= comments[i].id %>">
        <p class="floor"><%= comments[i].id %>楼<a href="javascript:;" class="delete">删除</a></p>
        <p class="author">层主：<span class="name"><%= comments[i].name %></span></p>
        <p class="email">邮箱：<span class="email"><%= comments[i].email %></span></p>
        <p class="content"><%= comments[i].body %></p>
      </li> <% } %> </script></head><body><div class="main"><div class="post"><h2>新年快乐</h2><p class="author">楼主：行痴</p><p class="txt">新的一年，祝大家新年快乐，身体健康，升职加薪！</p></div><div class="reply"><h4>发表回复</h4><p>用户名：<input type="text" class="user"></p><p>邮箱：<input type="text" class="email"></p><textarea class="editor"></textarea> <input type="button" value="发表" class="btn"></div><div class="cmts"><ul class="list"></ul></div></div><script>var $list=$(".cmts .list"),$btn=$(".reply .btn"),$user=$(".reply .user"),$email=$(".reply .email"),$editor=$(".reply .editor");function deleteData(){$(".cmts .list .delete").click(function(){$li=$(this).parents("li");var t=$li.attr("uid");$.ajax({url:"http://localhost:3000/comments/"+t,type:"DELETE"}),$li.remove()})}$.ajax({url:"http://localhost:3000/db",type:"GET",success:function(t){$list.html(template("tem",t)),deleteData()}}),$btn.click(function(){var t=$user.val(),e=$editor.val(),l=$email.val();$.ajax({url:"http://localhost:3000/comments",type:"POST",dataType:"json",data:{name:t,body:e,email:l},success:function(t){$list.append(template("tem",{comments:[t]})),deleteData()}}),$user.val(""),$editor.val(""),$email.val("")})</script></body></html>